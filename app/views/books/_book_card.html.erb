<div class="book-card">
  <div class="book-content">
    <h3>
      <%= link_to book_path(book) do %>
        <span class="truncate-title" title="<%= book.title %>"><%= book.title %></span>
      <% end %>
    </h3>
    <p class="byline"><%= book.author %></p>
    <% if book.image_url.present? %>
      <%= image_tag book.image_url, alt: "#{book.title} cover", class: "book-card-image" %>
    <% else %>
      <p>No cover image available.</p>
    <% end %>
    <p class="rating"><strong><%= book.average_rating || "â€”" %></strong> / 5</p>
  </div>

  <div class="book-actions">
    <%= link_to "View", book_path(book), class: "btn" %>
    <% if logged_in? %>
      <% if current_user.library_entries.exists?(book_id: book.id) %>
        <%= button_to "Remove from My Library",
              remove_from_library_book_path(book),
              method: :delete, class: "btn" %>
      <% else %>
        <%= button_to "Add to My Library",
              add_to_library_book_path(book),
              method: :post, class: "btn" %>
      <% end %>
    <% else %>
      <%= link_to "Sign in to save", new_session_path, class: "btn" %>
    <% end %>
  </div>
</div>
